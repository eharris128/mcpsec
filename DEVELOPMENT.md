# Development Guide

This guide covers how to run and develop the MCP Security Research site locally.

## Prerequisites

- Ruby (version 2.7 or higher)
- Bundler gem (`gem install bundler`)
- Git

## Local Development Setup

1. **Clone the repository**
   ```bash
   git clone https://github.com/eharris128/mcpsec.git
   cd mcpsec
   ```

2. **Install dependencies**
   ```bash
   bundle install
   ```

3. **Run the site locally**
   ```bash
   bundle exec jekyll serve
   ```

4. **View the site**
   - Open your browser to `http://localhost:4000`
   - The site will automatically rebuild when you make changes
   - RSS feed available at `http://localhost:4000/rss` or `http://localhost:4000/feed.xml`

## Project Structure

```
.
├── _advisories/           # Security advisory posts
├── _layouts/              # Page templates
├── _includes/             # Reusable components
├── assets/                # Images, CSS, and other static files
├── advisories/            # Advisory index page
├── _config.yml            # Jekyll configuration
├── index.md               # Homepage
└── about.md               # About page
```

## Adding a New Advisory

1. Create a new file in `_advisories/` with the naming format:
   ```
   YYYY-MM-DD-short-title.md
   ```

2. Add front matter at the top of the file:
   ```yaml
   ---
   layout: post
   title: "Full Advisory Title"
   date: YYYY-MM-DD
   categories: [category1, category2, security]
   excerpt: "Brief description of the vulnerability"
   image: /assets/og/YYYY-MM-DD-short-title.png
   ---
   ```

3. Write your advisory content in Markdown below the front matter

4. Test locally with `bundle exec jekyll serve`

5. Commit and push to deploy

**Note:** OpenGraph images are automatically generated via GitHub Actions when you push the advisory. The image path should match the advisory filename.

## Deployment

The site is deployed via GitHub Pages:
- **Production URL:** https://mcpsec.dev
- **Custom domain:** Configured via CNAME file
- **Deployment trigger:** Automatic on push to `master` branch

GitHub Pages automatically builds and deploys the site when changes are pushed to the master branch.

## Configuration

Key configuration settings in `_config.yml`:
- Site title and description
- Social media links
- Navigation menu items
- Collection settings for advisories
- Permalink structure
- RSS feed configuration (includes advisories collection)

## RSS Feed

The site provides an RSS/Atom feed for all security advisories:
- **Primary feed:** `https://mcpsec.dev/feed.xml`
- **Alias:** `https://mcpsec.dev/rss`

The feed is automatically generated by `jekyll-feed` and includes all advisories from the `_advisories` collection. New advisories are automatically added to the feed when published.

## OpenGraph Images

Social media preview images (OpenGraph images) are automatically generated for each advisory using GitHub Actions.

### How it works

1. When you push changes to `_advisories/`, a GitHub Action is triggered
2. The action runs a Node.js script using Puppeteer to generate 1200x630px images
3. Images are generated from an HTML template with the advisory title, date, and categories
4. Generated images are automatically committed to `assets/og/`
5. The images are referenced in each advisory's front matter via the `image` field

### Manual generation

To generate OG images locally:

```bash
# Install Node.js dependencies
npm install

# Generate images
npm run generate-og
```

### Customizing the design

Edit `_templates/og-image.html` to customize the OpenGraph image design. The template uses HTML/CSS and supports these variables:
- `{{TITLE}}` - Advisory title
- `{{DATE}}` - Publication date
- `{{CATEGORIES}}` - Advisory categories

## Troubleshooting

**Site not building locally?**
- Ensure all dependencies are installed: `bundle install`
- Check Ruby version: `ruby --version`
- Clear Jekyll cache: `bundle exec jekyll clean`

**Changes not appearing on live site?**
- Check GitHub Pages build status in repository settings
- Verify changes were pushed to master branch
- GitHub Pages may take a few minutes to rebuild

**404 errors for new advisories?**
- Verify file is in `_advisories/` directory
- Check front matter is properly formatted
- Ensure filename follows YYYY-MM-DD format
- Push a trivial commit to trigger rebuild if needed

## Contact

For questions about development, open an issue or contact [@Evan__Harris](https://x.com/Evan__Harris).
